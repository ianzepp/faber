# While loops - dum
# Maps Faber while loop syntax to target-language equivalents
#
# Syntax:
#   dum condition { body }              -- while loop
#   dum condition ergo statement        -- single-line while (not shown in tests)
#   dum condition { } cape err { }      -- while with catch clause

# =============================================================================
# Basic While Loops
# =============================================================================

# Simple while with boolean
- name: while with boolean
  faber: 'dum verum { scribe "loop" }'
  expect:
    ts:
      - 'while (true)'
      - 'console.log("loop")'
    py:
      - 'while True:'
      - 'print("loop")'
    rs:
      - 'while true'
      - 'println!("{}", String::from("loop"))'
    cpp:
      - 'while (true)'
      - 'std::print'
    zig:
      - 'while (true)'

# While with comparison
- name: while with comparison
  faber: 'dum x > 0 { x = x - 1 }'
  expect:
    ts:
      - 'while ((x > 0))'
      - 'x = (x - 1)'
    py:
      - 'while (x > 0):'
      - 'x = (x - 1)'
    rs:
      - 'while (x > 0)'
      - 'x = (x - 1);'
    cpp:
      - 'while ((x > 0))'
      - 'x = (x - 1);'
    zig:
      - 'while ((x > 0))'
      - 'x = (x - 1);'

# While with variable test
- name: while with variable condition
  faber: 'dum running { process() }'
  expect:
    ts:
      - 'while (running)'
      - 'process()'
    py:
      - 'while running:'
      - 'process()'
    rs:
      - 'while running'
      - 'process();'
    cpp:
      - 'while (running)'
      - 'process();'
    zig:
      - 'while (running)'
      - 'process();'

# =============================================================================
# While with Break/Continue
# =============================================================================

# While with break
- name: while with break
  faber: |
    dum verum {
      si done { rumpe }
    }
  expect:
    ts:
      - 'while (true)'
      - 'if (done)'
      - 'break;'
    py:
      - 'while True:'
      - 'if done:'
      - 'break'
    rs:
      - 'while true'
      - 'if done'
      - 'break;'
    cpp:
      - 'while (true)'
      - 'if (done)'
      - 'break;'
    zig:
      - 'while (true)'
      - 'if (done)'
      - 'break;'

# While with continue
- name: while with continue
  faber: |
    dum running {
      si skip { perge }
      work()
    }
  expect:
    ts:
      - 'while (running)'
      - 'if (skip)'
      - 'continue;'
      - 'work()'
    py:
      - 'while running:'
      - 'if skip:'
      - 'continue'
      - 'work()'
    rs:
      - 'while running'
      - 'if skip'
      - 'continue;'
      - 'work();'
    cpp:
      - 'while (running)'
      - 'if (skip)'
      - 'continue;'
      - 'work();'
    zig:
      - 'while (running)'
      - 'if (skip)'
      - 'continue;'
      - 'work();'

# =============================================================================
# While with Catch Clause (TypeScript/Python only)
# =============================================================================

# While with catch clause
- name: while with catch clause
  faber: |
    dum hasNext() {
      processItem()
    } cape err {
      handleError(err)
    }
  expect:
    ts:
      - 'try {'
      - 'while (hasNext())'
      - 'processItem()'
      - '} catch (err)'
      - 'handleError(err)'
    py:
      - 'try:'
      - 'while hasNext():'
      - 'processItem()'
      - 'except Exception as err:'
      - 'handleError(err)'
    rs:
      - 'while hasNext()'
      - 'processItem();'
    cpp:
      - 'while (hasNext())'
      - 'processItem();'
    zig:
      - 'while (hasNext())'
      - 'processItem();'
