# Importa - Import declaration codegen tests
# Covers: ex...importa, wildcard imports, norma intrinsics

# =============================================================================
# External Package Imports
# =============================================================================

# External package imports pass through unchanged
- name: 'external package import'
  input: 'ex "@hono/hono" importa Hono, Context'
  ts: 'import { Hono, Context } from "@hono/hono";'
  py: 'from @hono/hono import Hono, Context'
  zig:
      - 'const _@hono/hono = @import("@hono/hono");'
      - 'const Hono = _@hono/hono.Hono;'
      - 'const Context = _@hono/hono.Context;'
  rs: 'use @hono/hono::{Hono, Context};'

# Wildcard import
- name: 'wildcard import'
  input: 'ex "@lodash/lodash" importa *'
  ts:
      - 'import * as'
      - '@lodash/lodash'
  py: 'import @lodash/lodash'
  zig:
      - 'const @lodash/lodash = @import("@lodash/lodash");'
  rs: 'use @lodash/lodash::*;'

# =============================================================================
# Norma Intrinsics (TS-specific)
# =============================================================================
# These tests use not_contains to verify norma imports are suppressed

# norma imports don't emit import statements - they're handled as intrinsics
- name: 'norma imports are suppressed'
  input: 'ex "norma/tempus" importa nunc'
  ts:
      not_contains:
          - 'import'
  py: 'from norma/tempus import nunc'
  zig:
      - 'const _norma/tempus = @import("norma/tempus");'
      - 'const nunc = _norma/tempus.nunc;'
  rs:
      not_contains:
          - 'use'

# nunc() becomes Date.now() in TS
- name: 'nunc compiles to Date.now'
  input: |
      ex "norma/tempus" importa nunc
      fixum now = nunc()
  ts:
      contains:
          - 'const now = Date.now()'
      not_contains:
          - 'import'
  py:
      - 'from norma/tempus import nunc'
      - 'now = nunc()'
  zig:
      - 'const _norma/tempus = @import("norma/tempus");'
      - 'const nunc = _norma/tempus.nunc;'
      - 'const now = nunc();'
  cpp:
      - 'const auto now = nunc();'
  rs:
      contains:
          - 'let now = nunc();'
      not_contains:
          - 'use'

# SECUNDUM is a duration constant (1000ms)
- name: 'SECUNDUM compiles to literal'
  input: |
      ex "norma/tempus" importa SECUNDUM
      fixum sec = SECUNDUM
  ts:
      contains:
          - 'const sec = 1000'
      not_contains:
          - 'import'
  py:
      - 'from norma/tempus import SECUNDUM'
      - 'sec = SECUNDUM'
  zig:
      - 'const _norma/tempus = @import("norma/tempus");'
      - 'const SECUNDUM = _norma/tempus.SECUNDUM;'
      - 'const sec = SECUNDUM;'
  cpp:
      - 'const auto sec = SECUNDUM;'
  rs:
      contains:
          - 'let sec = SECUNDUM;'
      not_contains:
          - 'use'

# dormi() becomes Promise with setTimeout
- name: 'dormi compiles to Promise setTimeout'
  input: |
      ex "norma/tempus" importa dormi, SECUNDUM
      futura functio wait() {
        cede dormi(5 * SECUNDUM)
      }
  ts:
      contains:
          - 'await new Promise(r => setTimeout(r, (5 * 1000)))'
      not_contains:
          - 'import'
  py:
      - 'from norma/tempus import dormi, SECUNDUM'
      - 'async def wait():'
      - 'await dormi((5 * SECUNDUM))'
  zig:
      - 'const _norma/tempus = @import("norma/tempus");'
      - 'const dormi = _norma/tempus.dormi;'
      - 'const SECUNDUM = _norma/tempus.SECUNDUM;'
      - 'fn wait() !void {'
      - '_ = try dormi((5 * SECUNDUM));'
  cpp:
      - 'void wait() {'
      - 'dormi((5 * SECUNDUM));'
  rs:
      contains:
          - 'async fn wait() {'
          - 'dormi((5 * SECUNDUM)).await;'
      not_contains:
          - 'use'

# All duration constants compile to millisecond literals
- name: 'duration constants compile to literals'
  input: |
      ex "norma/tempus" importa MILLISECUNDUM, SECUNDUM, MINUTUM, HORA, DIES
      fixum a = MILLISECUNDUM
      fixum b = SECUNDUM
      fixum c = MINUTUM
      fixum d = HORA
      fixum e = DIES
  ts:
      contains:
          - 'const a = 1'
          - 'const b = 1000'
          - 'const c = 60000'
          - 'const d = 3600000'
          - 'const e = 86400000'
      not_contains:
          - 'import'
  py:
      - 'from norma/tempus import MILLISECUNDUM, SECUNDUM, MINUTUM, HORA, DIES'
      - 'a = MILLISECUNDUM'
      - 'b = SECUNDUM'
      - 'c = MINUTUM'
      - 'd = HORA'
      - 'e = DIES'
  zig:
      - 'const _norma/tempus = @import("norma/tempus");'
      - 'const MILLISECUNDUM = _norma/tempus.MILLISECUNDUM;'
      - 'const SECUNDUM = _norma/tempus.SECUNDUM;'
      - 'const MINUTUM = _norma/tempus.MINUTUM;'
      - 'const HORA = _norma/tempus.HORA;'
      - 'const DIES = _norma/tempus.DIES;'
      - 'const a = MILLISECUNDUM;'
      - 'const b = SECUNDUM;'
      - 'const c = MINUTUM;'
      - 'const d = HORA;'
      - 'const e = DIES;'
  cpp:
      - 'const auto a = MILLISECUNDUM;'
      - 'const auto b = SECUNDUM;'
      - 'const auto c = MINUTUM;'
  rs:
      contains:
          - 'let a = MILLISECUNDUM;'
          - 'let b = SECUNDUM;'
          - 'let c = MINUTUM;'
          - 'let d = HORA;'
          - 'let e = DIES;'
      not_contains:
          - 'use'
